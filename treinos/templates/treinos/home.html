{% extends 'treinos/base.html' %}
{% load static %}

{% block content %}
<div class="container-home" style="padding-bottom: 80px;">

    <header style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px; padding-top: 20px; border: none; background: transparent;">
        <div>
            <h1 style="font-size: 1.5rem; color: #fff; margin: 0; padding: 0;">OlÃ¡, {{ usuario.first_name|default:usuario.username }}!</h1>
            
            <p style="color: var(--text-muted); font-size: 0.9rem; margin-top: 6px; margin-bottom: 0; padding: 0;">Foco no objetivo hoje. ðŸ”¥</p>
        </div>
        
        <a href="{% url 'perfil' %}" style="width: 45px; height: 45px; border-radius: 50%; background: var(--bg-input); border: 1px solid var(--border); display: flex; align-items: center; justify-content: center; color: var(--primary); transition: all 0.2s ease-in-out;">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" /></svg>
        </a>
    </header>

    <section style="margin-bottom: 32px;">
        <h3 style="color: var(--text-muted); font-size: 0.8rem; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 12px;">Seu Ãšltimo Treino</h3>

        {% if ultimo_treino %}
            {% if ultimo_treino.tipo_historico == 'novo' %}
                <a href="{% url 'detalhe_treino' ultimo_treino.id %}" class="card card-ultimo-treino" style="display: flex; justify-content: space-between; align-items: center; text-decoration: none;">
            {% else %}
                <a href="{% url 'detalhe_treino_antigo' ultimo_treino.id %}" class="card card-ultimo-treino" style="display: flex; justify-content: space-between; align-items: center; text-decoration: none;">
            {% endif %}
            
                <div>
                    <h2 style="font-size: 1.1rem; color: #fff; margin-bottom: 5px;">
                        {{ ultimo_treino.rotina.nome|default:"Treino Finalizado" }}
                    </h2>
                    
                    <p style="color: var(--primary); font-size: 0.9rem; font-weight: 500; margin: 0;">
                        {{ ultimo_treino.data|date:"d M â€¢ H:i" }}
                        
                        {% if ultimo_treino.tipo_historico == 'antigo' %}
                            <span style="background: var(--bg-input); color: var(--text-muted); padding: 2px 6px; border-radius: 4px; font-size: 0.7rem; margin-left: 8px; border: 1px solid var(--border);">Legado</span>
                        {% endif %}
                    </p>
                </div>
                
                <div style="color: var(--text-muted);">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg>
                </div>
            </a>

        {% else %}
            <div class="card" style="text-align: center; border-style: dashed; padding: 30px;">
                <p style="color: var(--text-muted);">Nenhum treino registrado ainda.</p>
            </div>
        {% endif %}
    </section>

    <section>
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
            <h3 style="color: var(--text-muted); font-size: 0.8rem; text-transform: uppercase; letter-spacing: 1px; margin: 0;">Suas Rotinas</h3>
            
            <a href="{% url 'criar_rotina' %}" style="color: var(--primary); font-weight: 600; font-size: 0.9rem;">+ Nova</a>
        </div>

        <div class="card-list">
            {% for rotina in rotinas %}
            <div class="card">
                <div class="card-header" style="border-bottom: none; padding-bottom: 0;">
                    <div>
                        <div class="card-title">{{ rotina.nome }}</div>
                        <p style="padding: 0; margin-top: 4px;">{{ rotina.exercicios.count }} exercÃ­cios</p>
                    </div>
                    <a href="{% url 'detalhe_rotina' rotina.id %}" style="color: var(--text-muted); padding: 5px;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" /></svg>
                    </a>
                </div>

                <div style="padding: 0 24px 24px 24px;">
                    <a href="{% url 'iniciar_treino' rotina.id %}" class="btn-full">
                        INICIAR TREINO
                    </a>
                </div>
            </div>
            {% empty %}
                <div style="text-align: center; padding: 40px 0;">
                    <p style="color: var(--text-muted);">VocÃª ainda nÃ£o tem rotinas.</p>
                </div>
            {% endfor %}
        </div>
    </section>

</div>
{% endblock %}